# Uma Skill Manager

ゲーム「ウマ娘 プリティーダービー」のスキルおよびサポートカード（サポカ）を管理する CLI ツール

## 概要

本プロジェクトは以下の機能を提供する:

- **スキル検索・閲覧**: スキル名、効果、発動条件などで検索
- **サポカ管理**: 所持サポートカードの登録・管理、未所持スキルの把握
- **データ分析**: スキルの発動条件分析、効果比較

## データソース

スキルデータは [mee1080/umasim](https://mee1080.github.io/umasim/skill/) の「全てのスキル」から取得している。

- **出典**: DMM 版ウマ娘のダウンロードデータから抽出（mee1080 氏提供）
- **データファイル**: `assets/umasim_skill.txt`
- **更新方法**: 手動でデータソースからコピー＆ペースト

> **注意**: データの利用は自己責任で行うこと。

## データ構造

各スキルは以下の形式で記載されている:

```
スキル名
[衣装名]キャラ名 種別
スキル効果説明
評価点、人気ステータス、発動条件タイプ
->発動条件式
「条件の日本語解説」、効果パラメータ

（空行で区切り）
```

### サンプル

```
波乱注意砲！
[レッドストライフ]ゴールドシップ 固有
レース中間付近で後方にいるとロングスパートをかけて速度をわずかに上げ続ける
評価点240、人気:スピード30、確定発動
->distance_rate>=50&distance_rate<=60&order_rate>50
「距離割合50～60、順位率50より大（チャンミ6～/LoH7～）」、目標速度1500、持続6.0
```

### 主要フィールド

| フィールド | 説明 |
|-----------|------|
| スキル名 | スキルの名称 |
| サポカ名 | `[衣装名]キャラ名` 形式（サポカ所持スキルのみ） |
| 種別 | `固有` / `進化(元スキル名)` / なし（通常スキル） |
| 効果説明 | スキルの効果をゲーム内説明文で記載 |
| 評価点 | スキルの評価ポイント |
| 人気 | 取得時のステータスボーナス（例: スピード30） |
| 発動条件式 | 発動条件を変数・演算子で表現（`->` で開始） |
| 効果パラメータ | 目標速度、加速、持続時間、体力回復量など |

### スキル種別

| 種別 | 説明 |
|------|------|
| 固有 | サポートカード固有のスキル（約 259 件） |
| 進化 | 元スキルから派生した進化スキル |
| 通常 | サポカ名なしのレア/ノーマルスキル |

### 発動条件式の主要変数

| 変数 | 説明 |
|------|------|
| `distance_rate` | 距離割合（0-100%） |
| `order_rate` | 順位率（1位=0%、最下位=100%） |
| `phase` | レースフェーズ（0:序盤、1:中盤、2:終盤前半、3:終盤後半） |
| `corner` | コーナー判定（0:直線、!=0:コーナー） |
| `is_finalcorner` | 最終コーナー以降フラグ |
| `is_last_straight` | 最終直線フラグ |
| `remain_distance` | 残り距離（m） |
| `hp_per` | 残り体力（%） |

## セットアップ

### 必要環境

- Node.js 20.x 以上
- npm または pnpm

### インストール

```bash
# リポジトリをクローン
git clone <repository-url>
cd uma

# 依存パッケージをインストール
npm install
```

## 機能一覧（予定）

### Phase 1: データパーサー

- [ ] `umasim_skill.txt` のパース処理
- [ ] スキルデータの構造化（JSON 出力）
- [ ] サポートカード一覧の抽出

### Phase 2: CLI ツール

- [ ] スキル検索（名前、効果、条件）
- [ ] サポカ検索（キャラ名、衣装名）
- [ ] フィルタリング（種別、評価点、効果タイプ）

### Phase 3: 所持管理

- [ ] SQLite による所持サポカ管理
- [ ] 所持/未所持スキルの一覧表示
- [ ] スキル取得優先度の分析

## ディレクトリ構成（予定）

```
uma/
├── README.md
├── package.json
├── assets/
│   └── umasim_skill.txt  # データソース（手動更新）
├── src/
│   ├── parser/           # データパーサー
│   ├── db/               # SQLite 関連
│   ├── cli/              # CLI コマンド
│   └── types/            # 型定義
├── data/
│   └── uma.db            # SQLite データベース
└── tests/
```

## 開発ロードマップ

1. **Phase 1**: パーサー実装
   - データファイルの解析ロジック
   - スキル・サポカの型定義
   - JSON 出力機能

2. **Phase 2**: CLI ツール
   - 検索・フィルタリング機能
   - 対話的なコマンドインターフェース

3. **Phase 3**: 所持管理機能
   - SQLite データベース設計
   - 所持登録・削除・一覧
   - 未所持スキル分析

## ライセンス

MIT

## 謝辞

- スキルデータ提供: [mee1080/umasim](https://github.com/mee1080/umasim)
